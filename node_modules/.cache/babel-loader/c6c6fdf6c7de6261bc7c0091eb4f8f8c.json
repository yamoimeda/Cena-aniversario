{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import _objectSpread from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import{jsx as _jsx}from\"react/jsx-runtime\";import _defineProperty from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import{Button,TextField}from\"@material-ui/core\";import Dropzone,{useDropzone}from'react-dropzone';import firebase from'../../firebase';import{withRouter}from\"react-router\";export var Nuevopago=/*#__PURE__*/function(_Component){_inherits(Nuevopago,_Component);var _super=_createSuper(Nuevopago);function Nuevopago(){var _this;_classCallCheck(this,Nuevopago);_this=_super.call(this);_this.state={disabled:false,files:[],downloadURL:null,file:null,monto:\"\",montoer:false,id:undefined};_this.getAsText=function(fileToRead){var reader=new FileReader();// Read file into memory as UTF-8    \nreader.readAsDataURL(fileToRead);// Handle errors load\nreader.onload=_this.loadHandler;reader.onerror=_this.errorHandler;};_this.loadHandler=function(event){var _this$props=_this.props,handleChangefilebob=_this$props.handleChangefilebob,handleChange=_this$props.handleChange;var file=event.target.result;_this.setState({downloadURL:file,file:file});};_this.subircaptura=function(){var monto=_this.state.monto;console.log(monto);var routeChange=function routeChange(){var path=\"/koinonia\";_this.props.history.push(path);};if(_this.state.monto==\"\"){_this.setState({montoer:true});}else{if(_this.state.files.length!=0){var today=new Date();var dd=String(today.getDate()).padStart(2,'0');var mm=String(today.getMonth()+1).padStart(2,'0');//January is 0!\nvar yyyy=today.getFullYear();today=dd+'-'+mm+'-'+yyyy;var registro=firebase.firestore().collection(\"koinonia-registros\").doc(_this.state.id+today);var storageRef=firebase.storage().ref(\"koinonia/comprobantes\");_this.setState({id:registro.id});var listRef=storageRef.child(registro.id);listRef.putString(_this.state.file,'data_url').then(function(snapshot){snapshot.ref.getDownloadURL().then(function(downloadURL){registro.update({pagosurls:firebase.FieldValue.arrayUnion(downloadURL)}).then(function(){alert(\"cargado correctamente\");routeChange();}).catch(function(error){listRef.delete();alert(\"trate nuevamente\");console.error(\"Error writing document: \",error);});});});}}};_this.handleChange=function(event){return function(e){_this.setState(_defineProperty({},event,e.target.value));};};_this.onDrop=function(files){_this.getAsText(files[0]);_this.setState({files:files});};return _this;}_createClass(Nuevopago,[{key:\"componentDidMount\",value:function componentDidMount(){var id=this.props.match.params.id;this.setState({id:id});}},{key:\"errorHandler\",value:function errorHandler(evt){if(evt.target.error.name==\"NotReadableError\"){alert(\"Canno't read file !\");}}},{key:\"render\",value:function render(){var _this2=this;var files=this.state.files.map(function(file,index){return/*#__PURE__*/_jsx(\"li\",{children:file.name},file.name);});return/*#__PURE__*/_jsxs(\"section\",{className:\"formpago\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"textokoiform4\",children:\"Comprobante de pago\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"textokoiform4\",children:\"Agregue aqu\\xED el comprobante de pago.\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"textokoiform4\",children:\"Puede hacerlo por yappy @aposentoaltopty o por Global Bank Ministerio Evangelico El Aposento Alto cuenta corriente 01101232599.\"}),/*#__PURE__*/_jsx(Dropzone,{className:\"dropzone\",onDrop:this.onDrop,children:function children(_ref){var getRootProps=_ref.getRootProps,getInputProps=_ref.getInputProps;return/*#__PURE__*/_jsxs(\"section\",{className:\"container\",children:[/*#__PURE__*/_jsxs(\"div\",_objectSpread(_objectSpread({},getRootProps({className:'dropzone'})),{},{children:[/*#__PURE__*/_jsx(\"input\",_objectSpread({},getInputProps())),/*#__PURE__*/_jsx(\"p\",{children:\"Arrastre un archivo  o haga click para seleccionarlo (comprobante de dep\\xF3sito)\"}),/*#__PURE__*/_jsx(\"img\",{className:\"imagencaptura\",src:_this2.state.downloadURL||\"\",alt:\"Imagen\",height:\"120\"})]})),/*#__PURE__*/_jsxs(\"aside\",{children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Archivo\"}),/*#__PURE__*/_jsx(\"ul\",{children:files})]})]});}}),/*#__PURE__*/_jsx(TextField,{error:this.state.montoer,label:\"Monto a pagar\",onChange:this.handleChange(\"monto\"),defaultValue:this.state.monto,variant:\"outlined\",helperText:\"Monto pagado a la cuenta\",margin:\"normal\",InputLabelProps:{shrink:true},style:{marginLeft:5,marginBottom:0,width:\"91%\"}}),/*#__PURE__*/_jsxs(Button,{style:{background:\"#fa7b25\",color:\"#ffff\",width:\"80%\",height:\"10%\"},label:\"Continue\",onClick:function onClick(){return _this2.subircaptura();},children:[\" \",\"Subir\"]})]});}}]);return Nuevopago;}(Component);export default withRouter(Nuevopago);","map":{"version":3,"sources":["C:/Users/LabJH/Documents/yamir/cit/minaposento/src/components/Koinonia/Nuevopago.js"],"names":["React","Component","Button","TextField","Dropzone","useDropzone","firebase","withRouter","Nuevopago","state","disabled","files","downloadURL","file","monto","montoer","id","undefined","getAsText","fileToRead","reader","FileReader","readAsDataURL","onload","loadHandler","onerror","errorHandler","event","props","handleChangefilebob","handleChange","target","result","setState","subircaptura","console","log","routeChange","path","history","push","length","today","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","registro","firestore","collection","doc","storageRef","storage","ref","listRef","child","putString","then","snapshot","getDownloadURL","update","pagosurls","FieldValue","arrayUnion","alert","catch","error","delete","e","value","onDrop","match","params","evt","name","map","index","getRootProps","getInputProps","className","shrink","marginLeft","marginBottom","width","background","color","height"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport {\r\n  Button,\r\n  TextField\r\n} from \"@material-ui/core\";\r\nimport Dropzone, {useDropzone} from 'react-dropzone';\r\nimport firebase from '../../firebase'\r\nimport { withRouter } from \"react-router\";\r\n\r\nexport class Nuevopago extends Component {\r\n  \r\n  constructor() {\r\n    super();\r\n    this.onDrop = (files) => {\r\n        this.getAsText(files[0]);\r\n        this.setState({files:files})\r\n    }\r\n    \r\n  }\r\n\r\n  state = {\r\n    disabled: false,\r\n    files: [],\r\n    downloadURL: null,\r\n    file:null,\r\n    monto:\"\",\r\n    montoer:false,\r\n    id:undefined\r\n  };\r\n\r\n  componentDidMount(){\r\n      \r\n    const id = this.props.match.params.id;\r\n    this.setState({id:id})\r\n  }\r\n  getAsText=(fileToRead)=> {\r\n    var reader = new FileReader();\r\n    // Read file into memory as UTF-8    \r\n\r\n    reader.readAsDataURL(fileToRead);\r\n    // Handle errors load\r\n    reader.onload = this.loadHandler;\r\n    reader.onerror = this.errorHandler;\r\n  } \r\n\r\n  \r\n  loadHandler=(event)=>{\r\n    const {  handleChangefilebob,handleChange } = this.props;\r\n    var file = event.target.result;\r\n    this.setState({downloadURL:file,file:file})\r\n    \r\n  }\r\n\r\n  errorHandler(evt) {\r\n    if(evt.target.error.name == \"NotReadableError\") {\r\n        alert(\"Canno't read file !\");\r\n    }\r\n  }\r\n   \r\n\r\n  subircaptura = ()=>{\r\n      var monto = this.state.monto\r\n      console.log(monto);\r\n   const routeChange= ()=>{\r\n        let path = `/koinonia`;\r\n        this.props.history.push(path);\r\n      }\r\n    if (this.state.monto == \"\"){\r\n        this.setState({montoer:true})\r\n    }else{\r\n       \r\n        if(this.state.files.length != 0){\r\n            \r\n            var today = new Date();\r\n            var dd = String(today.getDate()).padStart(2, '0');\r\n            var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n            var yyyy = today.getFullYear();\r\n      \r\n            today = dd + '-' + mm + '-' + yyyy;\r\n          var registro = firebase.firestore().collection(\"koinonia-registros\").doc(this.state.id+today)\r\n          var storageRef = firebase.storage().ref(\"koinonia/comprobantes\");\r\n          this.setState({ id: registro.id });\r\n          var listRef = storageRef.child(registro.id);\r\n          listRef.putString(this.state.file, 'data_url').then(function(snapshot) {\r\n           snapshot.ref.getDownloadURL().then(function(downloadURL) {\r\n                \r\n               registro.update({\r\n                pagosurls: firebase.FieldValue.arrayUnion(downloadURL)\r\n              \r\n              \r\n          }).then(()=>{\r\n              alert(\"cargado correctamente\")\r\n            routeChange()\r\n          }).catch((error) => {\r\n                listRef.delete()\r\n              alert(\"trate nuevamente\")\r\n                 \r\n            console.error(\"Error writing document: \", error);\r\n        });\r\n            });\r\n      \r\n          });\r\n      \r\n          }\r\n    }\r\n\r\n  }\r\n\r\n  handleChange =event =>e=>{\r\n\r\n    this.setState({ [event]: e.target.value  });\r\n  }\r\n \r\n\r\n  render() {\r\n\r\n    const files =this.state.files.map((file,index) => (\r\n        <li key={file.name}>\r\n          {file.name}\r\n        </li>\r\n      ));\r\n    return (\r\n        <section className=\"formpago\" >\r\n            <h3 className=\"textokoiform4\">Comprobante de pago</h3>\r\n            <h4 className=\"textokoiform4\">Agregue aquí el comprobante de pago.</h4>\r\n            <h4 className=\"textokoiform4\">Puede hacerlo por yappy @aposentoaltopty o por Global Bank Ministerio Evangelico El Aposento Alto cuenta corriente 01101232599.</h4>\r\n         <Dropzone  className='dropzone'   onDrop={this.onDrop}>\r\n        {({getRootProps, getInputProps}) => (\r\n          <section className=\"container\">\r\n            <div {...getRootProps({className: 'dropzone'})}>\r\n              <input {...getInputProps()} />\r\n              <p>Arrastre un archivo  o haga click para seleccionarlo (comprobante de depósito)</p>\r\n              <img\r\n                  className=\"imagencaptura\"\r\n                  src={this.state.downloadURL || \"\"}\r\n                  alt=\"Imagen\"\r\n                  height=\"120\"\r\n                  \r\n                />\r\n            </div>\r\n            <aside>\r\n              <h4>Archivo</h4>\r\n              <ul>{files}</ul>\r\n            </aside>\r\n          </section>\r\n        )}\r\n      </Dropzone>\r\n      <TextField\r\n          error={this.state.montoer}\r\n          label=\"Monto a pagar\"\r\n          onChange={this.handleChange(\"monto\")}\r\n          defaultValue={this.state.monto}\r\n          variant=\"outlined\" \r\n          helperText=\"Monto pagado a la cuenta\"\r\n          margin=\"normal\"\r\n          InputLabelProps={{\r\n            shrink: true,\r\n          }}\r\n          style={{ marginLeft: 5,marginBottom:0,  width: \"91%\"}}\r\n        />\r\n        <Button\r\n          style={{background: \"#fa7b25\", color: \"#ffff\",\r\n            width: \"80%\", height:\"10%\"\r\n          }}\r\n          label=\"Continue\"\r\n          onClick={()=>this.subircaptura()}\r\n        >\r\n          {\" \"}\r\n          Subir\r\n        </Button>\r\n      </section>\r\n    );\r\n  }\r\n}\r\n\r\nexport default withRouter(Nuevopago);\r\n"]},"metadata":{},"sourceType":"module"}