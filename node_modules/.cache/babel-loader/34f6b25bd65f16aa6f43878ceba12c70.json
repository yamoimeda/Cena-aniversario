{"ast":null,"code":"import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";import _defineProperty from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _classCallCheck from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/LabJH/Documents/yamir/cit/minaposento/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Datospersonales from\"./componentes/datospersonales\";import Captura from\"./componentes/captura\";import Codigofinal from\"./componentes/codidofinal\";import\"react-step-progress-bar/styles.css\";import{ProgressBar,Step}from\"react-step-progress-bar\";import lgmeeaa from\"./componentes/logo_aposento nuevo-01.png\";import firebase from'../../firebase';export var UserForm=/*#__PURE__*/function(_Component){_inherits(UserForm,_Component);var _super=_createSuper(UserForm);function UserForm(){var _this;_classCallCheck(this,UserForm);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={step:1,firstName:\"\",lastName:\"\",email:\"\",red:\"\",igle:\"\",tipo:\"\",cedula:\"\",id:\"\",url:\"\",urlcap:\"\",files:[],monto:\"\",adelante:true,file:undefined};_this.nextStep=function(){console.log(\"hola\");var cuenta=0;var pansar=function pansar(){_this.setState({step:step+1});};var _this$state=_this.state,step=_this$state.step,firstName=_this$state.firstName,lastName=_this$state.lastName,email=_this$state.email,red=_this$state.red,igle=_this$state.igle,tipo=_this$state.tipo,cedula=_this$state.cedula,monto=_this$state.monto;var snapshot=firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula).get();if(igle==\"Panamá\"){if(firstName==\"\"||lastName==\"\"||email==\"\"||tipo==\"\"||cedula==\"\"||monto==\"\"||igle==\"\"||red==\"\"){alert(\"Por favor llene todos los campos\");}else{firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula).get().then(function(querySnapshot){querySnapshot.forEach(function(doc){cuenta=cuenta+1;});if(cuenta>0){alert(\"Esta persona ya está registrada\");}else{pansar();}});}}else{if(firstName==\"\"||lastName==\"\"||email==\"\"||tipo==\"\"||cedula==\"\"||monto==\"\"||igle==\"\"){alert(\"Por favor llene todos los campos\");}else{firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula).get().then(function(querySnapshot){querySnapshot.forEach(function(doc){cuenta=cuenta+1;});if(cuenta>0){alert(\"Esta persona ya está registrada\");}else{pansar();}});}}};_this.adelante=function(){var step=_this.state.step;_this.setState({step:step+1});};_this.prevStep=function(){var step=_this.state.step;_this.setState({step:step-1});};_this.firstStep=function(){_this.setState({step:1});};_this.handleChange=function(input){return function(e){_this.setState(_defineProperty({},input,e.target.value));};};_this.handleChangefile=function(input){_this.setState({files:input});};_this.handleChangeid=function(input){_this.setState({id:input});};_this.handleChangefilebob=function(input){_this.setState({file:input});};_this.handleChangeigle=function(input){_this.setState({igle:input});};_this.subircaptura=function(){if(_this.state.adelante){_this.setState({adelante:false});var cuenta=0;var pasar=0;var handleChangeid=function handleChangeid(input){_this.setState({id:input});};var adelante=function adelante(){var step=_this.state.step;_this.setState({step:step+1});};var _this$state2=_this.state,step=_this$state2.step,url=_this$state2.url,firstName=_this$state2.firstName,lastName=_this$state2.lastName,email=_this$state2.email,red=_this$state2.red,igle=_this$state2.igle,tipo=_this$state2.tipo,cedula=_this$state2.cedula,monto=_this$state2.monto;if(_this.state.files.length!=0){var today=new Date();var dd=String(today.getDate()).padStart(2,'0');var mm=String(today.getMonth()+1).padStart(2,'0');//January is 0!\nvar yyyy=today.getFullYear();today=dd+'-'+mm+'-'+yyyy;var registro=firebase.firestore().collection(\"cena-registros\").doc();var storageRef=firebase.storage().ref(\"cena/comprobantes\");_this.setState({id:registro.id});var listRef=storageRef.child(registro.id);console.log('aca qui bien');listRef.putString(_this.state.file,'data_url').then(function(snapshot){snapshot.ref.getDownloadURL().then(function(downloadURL){handleChangeid(registro.id);registro.set({uid:registro.id,nombre:firstName,apellido:lastName,//correo: email,\nred:red,igle:igle,tipo:tipo,cedula:cedula,fecha:today,url:downloadURL,pagosurl:[downloadURL],verificado:0,monto:parseFloat(monto),pagado:0}).then(function(){console.log('hasta qui tan bien');adelante();}).catch(function(error){alert(\"No se pudo subir su registro, porfa recargue la pagina e intentelo nuevamente\");listRef.delete().then(function(){// File deleted successfully\n});console.error(\"Error writing document: \",error);});});});}}};return _this;}_createClass(UserForm,[{key:\"renderSwitch\",value:function renderSwitch(step){var _this$state3=this.state,firstName=_this$state3.firstName,lastName=_this$state3.lastName,email=_this$state3.email,igle=_this$state3.igle,red=_this$state3.red,files=_this$state3.files,tipo=_this$state3.tipo,cedula=_this$state3.cedula,id=_this$state3.id,file=_this$state3.file,urlcap=_this$state3.urlcap,monto=_this$state3.monto;var values={firstName:firstName,lastName:lastName,email:email,red:red,igle:igle,files:files,tipo:tipo,cedula:cedula,id:id,file:file,urlcap:urlcap,monto:monto};switch(step){default:return/*#__PURE__*/_jsx(\"h1\",{children:\"User Forms not working. Enable Javascript!\"});case 1:return/*#__PURE__*/_jsx(Datospersonales,{nextStep:this.nextStep,handleChange:this.handleChange,handleChangeigle:this.handleChangeigle,values:values});case 2:return/*#__PURE__*/_jsx(Captura,{subircap:this.subircaptura,prevStep:this.prevStep,handleChangefile:this.handleChangefile,handleChange:this.handleChange,handleChangefilebob:this.handleChangefilebob,values:values});case 3:return/*#__PURE__*/_jsx(Codigofinal,{handleChange:this.handleChange,prevStep:this.prevStep,values:values});//\n}}},{key:\"render\",value:function render(){var step=this.state.step;return/*#__PURE__*/_jsxs(\"div\",{className:\"formularioCont\",ref:this.props.refProp,children:[/*#__PURE__*/_jsx(\"div\",{className:\"barradeprogreso\",children:/*#__PURE__*/_jsxs(ProgressBar,{percent:100/3*step,filledBackground:\"linear-gradient(to right, #fefb72, #f0bb31)\",children:[/*#__PURE__*/_jsx(Step,{transition:\"scale\",children:function children(_ref){var accomplished=_ref.accomplished;return/*#__PURE__*/_jsx(\"img\",{style:{filter:\"grayscale(\".concat(accomplished?0:80,\"%)\")},width:\"30\",src:lgmeeaa});}}),/*#__PURE__*/_jsx(Step,{transition:\"scale\",children:function children(_ref2){var accomplished=_ref2.accomplished;return/*#__PURE__*/_jsx(\"img\",{style:{filter:\"grayscale(\".concat(accomplished?0:80,\"%)\")},width:\"30\",src:lgmeeaa});}}),/*#__PURE__*/_jsx(Step,{transition:\"scale\",children:function children(_ref3){var accomplished=_ref3.accomplished;return/*#__PURE__*/_jsx(\"img\",{style:{filter:\"grayscale(\".concat(accomplished?0:80,\"%)\")},width:\"30\",src:lgmeeaa});}})]})}),this.renderSwitch(step)]});}}]);return UserForm;}(Component);export default UserForm;","map":{"version":3,"sources":["C:/Users/LabJH/Documents/yamir/cit/minaposento/src/components/Koinonia/formulario.js"],"names":["React","Component","Datospersonales","Captura","Codigofinal","ProgressBar","Step","lgmeeaa","firebase","UserForm","state","step","firstName","lastName","email","red","igle","tipo","cedula","id","url","urlcap","files","monto","adelante","file","undefined","nextStep","console","log","cuenta","pansar","setState","snapshot","firestore","collection","where","get","alert","then","querySnapshot","forEach","doc","prevStep","firstStep","handleChange","input","e","target","value","handleChangefile","handleChangeid","handleChangefilebob","handleChangeigle","subircaptura","pasar","length","today","Date","dd","String","getDate","padStart","mm","getMonth","yyyy","getFullYear","registro","storageRef","storage","ref","listRef","child","putString","getDownloadURL","downloadURL","set","uid","nombre","apellido","fecha","pagosurl","verificado","parseFloat","pagado","catch","error","delete","values","props","refProp","accomplished","filter","renderSwitch"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport Datospersonales from \"./componentes/datospersonales\";\r\nimport Captura from \"./componentes/captura\";\r\nimport Codigofinal from \"./componentes/codidofinal\";\r\nimport \"react-step-progress-bar/styles.css\";\r\nimport { ProgressBar, Step } from \"react-step-progress-bar\";\r\nimport lgmeeaa from \"./componentes/logo_aposento nuevo-01.png\";\r\nimport firebase from '../../firebase';\r\n\r\nexport class UserForm extends Component {\r\n  state = {\r\n    step: 1,\r\n    firstName: \"\",\r\n    lastName: \"\",\r\n    email: \"\",\r\n    red: \"\",\r\n    igle: \"\",\r\n    tipo:\"\",\r\n    cedula:\"\",\r\n    id:\"\",\r\n    url:\"\",\r\n    urlcap:\"\",\r\n    files:[],\r\n    monto:\"\",\r\n    adelante:true,\r\n    file:undefined\r\n  };\r\n  // Go to next step\r\n  nextStep = () => {\r\n    console.log(\"hola\");\r\n    var cuenta = 0\r\n    const pansar = ()=>{\r\n      this.setState({\r\n        step: step + 1\r\n      });\r\n    }\r\n    const { step,firstName, lastName,email,red,igle,tipo,\r\n    cedula,monto } = this.state;\r\n\r\n\r\n    const snapshot = firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula)\r\n    .get();\r\n    if(igle ==\"Panamá\"){\r\n      if(firstName == \"\" || lastName == \"\" || email == \"\"  || tipo== \"\" ||\r\n      cedula == \"\"|| monto==\"\" || igle ==\"\"|| red ==\"\"){\r\n       \r\n        alert(\"Por favor llene todos los campos\")\r\n      }else{\r\n        firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula)\r\n        .get()\r\n        .then((querySnapshot) => {\r\n          querySnapshot.forEach((doc) => {\r\n              cuenta = cuenta+1\r\n             });\r\n          \r\n             if(cuenta>0){\r\n              alert(\"Esta persona ya está registrada\")\r\n             }else{\r\n              pansar()\r\n             }\r\n          \r\n          })\r\n\r\n        \r\n      }\r\n\r\n    }else{\r\n      if(firstName == \"\" || lastName == \"\" || email == \"\"  || tipo== \"\" ||\r\n      cedula == \"\"|| monto==\"\" || igle ==\"\"){\r\n       \r\n        alert(\"Por favor llene todos los campos\")\r\n      }else{\r\n        firebase.firestore().collection(\"cena-registros\").where(\"cedula\",\"==\",cedula)\r\n        .get()\r\n        .then((querySnapshot) => {\r\n          querySnapshot.forEach((doc) => {\r\n              cuenta = cuenta+1\r\n             });\r\n          \r\n             if(cuenta>0){\r\n              alert(\"Esta persona ya está registrada\")\r\n             }else{\r\n              pansar()\r\n             }\r\n          \r\n          })\r\n      }\r\n\r\n    }\r\n\r\n    \r\n   \r\n    \r\n  };\r\n  adelante= ()=>{\r\n    const { step } = this.state;\r\n    this.setState({\r\n      step: step + 1\r\n    });\r\n  }\r\n  // Go to prev step\r\n  prevStep = () => {\r\n    const { step } = this.state;\r\n    this.setState({\r\n      step: step - 1\r\n    });\r\n  };\r\n  firstStep = () => {\r\n    this.setState({\r\n      step: 1\r\n    });\r\n  };\r\n  // Handle fields change\r\n  handleChange = input => e => {\r\n    this.setState({ [input]: e.target.value });\r\n  };\r\n  handleChangefile = (input) =>  {\r\n    this.setState({ files: input });\r\n  };\r\n  handleChangeid = (input) =>  {\r\n    this.setState({ id: input });\r\n  };\r\n  handleChangefilebob= input =>{\r\n    this.setState({ file: input });\r\n    \r\n  }\r\n  handleChangeigle= input =>{\r\n    this.setState({ igle: input });\r\n    \r\n  }\r\n  subircaptura=()=>{\r\n    if(this.state.adelante){\r\n      this.setState({adelante:false})\r\n    \r\n    var cuenta=0\r\n    var pasar =0\r\n    const handleChangeid = (input) =>  {\r\n      this.setState({ id: input });\r\n    };\r\n    const adelante= ()=>{\r\n      const { step } = this.state;\r\n      this.setState({\r\n        step: step + 1\r\n      });\r\n    }\r\n    const { step,url,firstName,lastName,email,red,igle,tipo,cedula,monto } = this.state;\r\n    \r\n    if(this.state.files.length != 0){\r\n      var today = new Date();\r\n      var dd = String(today.getDate()).padStart(2, '0');\r\n      var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!\r\n      var yyyy = today.getFullYear();\r\n\r\n    today = dd + '-' + mm + '-' + yyyy;\r\n\r\n   \r\n      \r\n    var registro = firebase.firestore().collection(\"cena-registros\").doc()\r\n    var storageRef = firebase.storage().ref(\"cena/comprobantes\");\r\n    this.setState({ id: registro.id });\r\n    var listRef = storageRef.child(registro.id);\r\n    console.log('aca qui bien')\r\n    listRef.putString(this.state.file, 'data_url').then(function(snapshot) {\r\n    snapshot.ref.getDownloadURL().then(function(downloadURL) {\r\n     \r\n      handleChangeid(registro.id)\r\n        registro.set({\r\n        uid: registro.id,\r\n        nombre: firstName,\r\n        apellido: lastName,\r\n        //correo: email,\r\n        red: red,\r\n        igle: igle,\r\n        tipo: tipo,\r\n        cedula: cedula,\r\n        fecha: today,\r\n        url:downloadURL,\r\n        pagosurl:[downloadURL],\r\n        verificado:0,\r\n        monto: parseFloat(monto),\r\n        pagado:0\r\n        \r\n    })\r\n    .then(() => {\r\n      console.log('hasta qui tan bien')\r\n      adelante()\r\n  }).catch((error) => {\r\n      alert(\"No se pudo subir su registro, porfa recargue la pagina e intentelo nuevamente\")\r\n      listRef.delete().then(function() {\r\n        // File deleted successfully\r\n      })\r\n      console.error(\"Error writing document: \", error);\r\n  });\r\n      });\r\n\r\n    });\r\n\r\n     \r\n    \r\n\r\n    \r\n    }\r\n  }\r\n  }\r\n  renderSwitch(step) {\r\n    const { firstName, lastName, email, igle, red ,files,tipo,cedula,id,file,urlcap,monto} = this.state;\r\n    const values = { firstName, lastName, email, red, igle,files,tipo,cedula,id,file,urlcap,monto };\r\n\r\n    switch (step) {\r\n        default:\r\n          return <h1>User Forms not working. Enable Javascript!</h1>;\r\n        case 1:\r\n          return (\r\n            <Datospersonales\r\n              nextStep={this.nextStep}\r\n              handleChange={this.handleChange}\r\n              handleChangeigle= {this.handleChangeigle}\r\n              values={values}\r\n            />\r\n          );\r\n        case 2:\r\n          return (\r\n            <Captura\r\n              subircap={this.subircaptura}\r\n              prevStep={this.prevStep}\r\n              handleChangefile={this.handleChangefile}\r\n              handleChange={this.handleChange}\r\n              handleChangefilebob={this.handleChangefilebob}\r\n              values={values}\r\n            />\r\n          );\r\n        case 3:\r\n          return (\r\n            <Codigofinal\r\n              handleChange={this.handleChange}\r\n              prevStep={this.prevStep}\r\n              values={values}\r\n            />\r\n          );\r\n        //\r\n       \r\n      }\r\n  }\r\n\r\n  render() {\r\n    const { step } = this.state;\r\n  \r\n\r\n   return(\r\n       <div className=\"formularioCont\" ref={this.props.refProp}>\r\n           <div className=\"barradeprogreso\">\r\n                <ProgressBar\r\n                        percent={100/3*step}\r\n                        filledBackground=\"linear-gradient(to right, #fefb72, #f0bb31)\"\r\n                    \r\n                    >\r\n                        <Step transition=\"scale\">\r\n                        {({ accomplished }) => (\r\n                            <img\r\n                            style={{ filter: `grayscale(${accomplished ? 0 : 80}%)` }}\r\n                            width=\"30\"\r\n                            src={lgmeeaa}\r\n                            />\r\n                        )}\r\n                        </Step>\r\n                        <Step transition=\"scale\">\r\n                        {({ accomplished }) => (\r\n                            <img\r\n                            style={{ filter: `grayscale(${accomplished ? 0 : 80}%)` }}\r\n                            width=\"30\"\r\n                            src={lgmeeaa}/>\r\n                        )}\r\n                        </Step>\r\n                        <Step transition=\"scale\">\r\n                        {({ accomplished }) => (\r\n                            <img\r\n                            style={{ filter: `grayscale(${accomplished ? 0 : 80}%)` }}\r\n                            width=\"30\"\r\n                            src={lgmeeaa}/>\r\n                        )}\r\n                        </Step>\r\n                    </ProgressBar>\r\n\r\n                    </div>\r\n           {this.renderSwitch(step)}\r\n\r\n       </div>\r\n   )\r\n  }\r\n}\r\nexport default UserForm;\r\n"]},"metadata":{},"sourceType":"module"}